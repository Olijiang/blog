import{_ as E,A as k,o as u,f as g,g as c,w as n,T as v,h as r,t as m,j as d,F as T,l as x,i as H,m as I,v as C,k as z,p as S,n as A}from"./index.de08f477.js";import{E as V,a as j,b as B}from"./el-image-viewer.660ee909.js";import{E as L}from"./el-tag.4a35146c.js";import{m as N}from"./markdown.fab8dcaa.js";const D={components:{},props:["articleId"],data(){return{headings:[],curHeading:"",articleHtml:"",article:{title:"",category:"",tag:[],content:"",img:""},tocContent:"",tocId:[],tocTop:20,timeout:null,lastTag:null,scrollTag:!1,ok:!1}},methods:{detecator(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let o=document.documentElement.scrollTop||document.body.scrollTop;this.tocId.forEach(a=>{document.querySelector(a).offsetTop+620-o<=10&&(this.lastTag=a,this.scrollTag=!0)}),o<600&&(this.lastTag=this.tocId[0])},100)},jump(o){document.querySelector(o).scrollIntoView({behavior:"smooth"}),this.lastTag=o,console.log("jump",o),this.scrollTag=!1},generateToc(){let o=/<h[1-3]>(.{0,50})<\/h[1-3]>/g,a=this.articleHtml.match(o),e=[],t=0;for(let l=0;l<a.length;l++){let s=a[l];if(e[t]==null){e[t]={},e[t].level=t+1,e[t].tag=s,e[t].text=s.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),e[t].children=[],e[t].href="#hool"+e[t].level,a[l]=s.substring(0,3)+" id='hool"+e[t].level+"'"+s.substring(3),this.articleHtml=this.articleHtml.replace(s,a[l]),this.tocId.push(e[t].href);continue}if(s[2]>e[t].tag[2]){let i={};i.level=e[t].level+"."+(e[t].children.length+1),i.tag=s,i.text=s.replace(/<h[1-3]>/g,"").replace(/<\/h[1-3]>/g,""),i.href="#hool"+e[t].level+"_"+(e[t].children.length+1),e[t].children.push(i),a[l]=s.substring(0,3)+" id='hool"+i.level.replace(".","_")+"'"+s.substring(3),this.articleHtml=this.articleHtml.replace(s,a[l]),this.tocId.push(i.href)}else t++,l--}this.tocContent=e}},computed:{},watch:{lastTag:{handler(o,a){let e=document.getElementById("toc"),t=document.documentElement.scrollHeight,l=document.documentElement.scrollTop;this.scrollTag&&(e.scrollTop=l/t*e.scrollHeight-200),this.tocId.forEach(s=>{let p=document.querySelector(s+"f");s==o?(p.style.backgroundColor="#b2fffe",p.style.color="#0400ff"):(p.style.backgroundColor="",p.style.color="")})}}},mounted(){let o={ArticleId:this.articleId};k.get("init/getArticle",o).then(a=>{this.article=a.data,this.article.img=this.baseUrl+this.article.img,this.article.tag=JSON.parse(this.article.tag).tags;let e={filePath:this.article.content};k.get("init/getContent",e).then(t=>{t.code==200&&(this.articleHtml=N(t.data),this.generateToc(),this.ok=!0,setTimeout(()=>{this.lastTag=this.tocId[0],window.addEventListener("scroll",this.detecator)},200))})})},unmounted(){window.removeEventListener("scroll",this.detecator)}},q=o=>(S("data-v-e81d6779"),o=o(),A(),o),F={class:"illustration"},M={class:"ArticleInfo"},P={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"50px"}},J={style:{margin:"10px"}},O={style:{margin:"10px"}},R=["innerHTML"],U={id:"toc",class:"articleCatelog"},G=q(()=>r("h3",null,"\u76EE \u5F55",-1)),K=["id","onClick"],Q={key:0},W=["onClick","id"];function X(o,a,e,t,l,s){const p=V,i=L,_=j,b=B;return u(),g("div",null,[c(v,{name:"el-fade-in"},{default:n(()=>[r("div",F,[c(p,{fit:"cover",class:"img",src:l.article.img,alt:""},null,8,["src"]),r("div",M,[r("h1",P,m(l.article.title),1),r("p",J,[c(i,{type:"success",style:{"font-size":"15px"}},{default:n(()=>[d(" \u521B\u4F5C\u65F6\u95F4 ")]),_:1}),d(": "),c(i,{type:"danger",style:{"font-size":"15px"}},{default:n(()=>[d(m(l.article.createTime),1)]),_:1})]),r("p",O,[c(i,{type:"success",style:{"font-size":"15px"}},{default:n(()=>[d(" \u5206\u7C7B ")]),_:1}),d(": "),c(i,{type:"danger",style:{"font-size":"15px"}},{default:n(()=>[d(m(l.article.category),1)]),_:1}),c(i,{type:"success",style:{"font-size":"15px","margin-left":"20px"}},{default:n(()=>[d(" \u6807\u7B7E ")]),_:1}),d(": "),(u(!0),g(T,null,x(l.article.tag,(h,y)=>(u(),H(i,{type:"danger",style:{"font-size":"15px","margin-right":"10px"},key:y},{default:n(()=>[d(m(h),1)]),_:2},1024))),128))])])])]),_:1}),c(b,null,{default:n(()=>[c(_,{class:"vacancy"}),c(_,{class:"space"}),c(_,{class:"articleCol"},{default:n(()=>[c(v,{name:"el-zoom-in-top"},{default:n(()=>[I(r("div",{class:"markdown-body",innerHTML:l.articleHtml},null,8,R),[[C,l.ok]])]),_:1})]),_:1}),c(_,{class:"space"}),c(_,{class:"catelogCol"},{default:n(()=>[c(v,{name:"el-zoom-in-top"},{default:n(()=>[I(r("div",U,[G,r("ol",null,[(u(!0),g(T,null,x(l.tocContent,(h,y)=>(u(),g("li",{key:y},[r("span",{class:"toc_item",id:h.href.substring(1)+"f",onClick:f=>s.jump(h.href)},m(h.level)+". "+m(h.text),9,K),h.children.length!=0?(u(),g("ol",Q,[(u(!0),g(T,null,x(h.children,(f,w)=>(u(),g("li",{key:w,style:{"padding-left":"20px"}},[r("span",{class:"toc_item",onClick:Y=>s.jump(f.href),id:f.href.substring(1)+"f"},m(f.level)+". "+m(f.text),9,W)]))),128))])):z("",!0)]))),128))])],512),[[C,l.ok]])]),_:1})]),_:1})]),_:1})])}const le=E(D,[["render",X],["__scopeId","data-v-e81d6779"]]);export{le as default};
