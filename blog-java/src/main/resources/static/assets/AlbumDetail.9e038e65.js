import{_ as q,c as N,A as y,E as C,a as T,r as E,b as z,d as B,e as U,o as m,f as u,g as l,w as i,T as p,h as n,t as D,i as V,j as _,k as x,F as L,l as P,m as g,v as h,p as H,n as M}from"./index.de08f477.js";/* empty css                */import{E as j,a as R,b as G}from"./el-image-viewer.660ee909.js";const J={components:{CircleCheckFilled:N},props:["data"],data(){return{previewDialog:!1,dialogImageUrl:"",editFlag:!1,authorId:"",albumName:"",images:[],originalImg:[],endmsg:"\u4E0B\u62C9\u52A0\u8F7D\u66F4\u591A...",queryData:{authorId:"",albumName:"",startPage:0,pageSize:4},selectedImage:[],selectAllFlag:!0}},methods:{previewImage(e){this.dialogImageUrl=e,this.previewDialog=!0},handleScroll(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{let e=document.documentElement.scrollTop,t=document.documentElement.clientHeight,a=document.documentElement.scrollHeight;t+e-a>-10&&(this.endmsg="\u6B63\u5728\u52A0\u8F7D...",y.get("init/getImagesByAlbum",this.queryData).then(r=>{r.code==200&&(r.data.forEach(s=>{s.ok=!1,s.simplifyImg=this.baseUrl+s.simplifyImg,s.originalImg=this.baseUrl+s.originalImg,this.images.push(s),this.originalImg.push(s.originalImg)}),setTimeout(()=>{let s=this.images.length,o=s-r.data.length;for(o;o<s;o++)this.images[o].ok=!0},100),r.data.length<this.queryData.pageSize&&(this.endmsg="\u6CA1\u6709\u66F4\u591A\u4E86...",window.removeEventListener("scroll",this.handleScroll))),this.queryData.startPage=this.queryData.startPage+8}))},100)},management(){this.selectedImage=[],this.editFlag=!this.editFlag,this.images.forEach(e=>{e.select=!1})},selectImage(e){e.select=!e.select,e.select?this.selectedImage.push(e.id):this.selectedImage.forEach((t,a)=>{if(t.id==e.id){this.selectedImage.splice(a,1);return}})},moveImage(){},deleteImage(){if(this.selectedImage.length==0){C({showClose:!0,message:"\u8BF7\u9009\u62E9\u56FE\u7247",type:"warning"});return}T.confirm("\u786E\u8BA4\u5220\u9664?","\u63D0\u793A\u6846",{distinguishCancelAndClose:!0,confirmButtonText:"\u662F",cancelButtonText:"\u5426",type:"warning",customStyle:{top:"-20% !important",position:"relative"}}).then(()=>{y.post("image/delete",this.selectedImage).then(e=>{e.code==200&&(this.selectedImage.forEach(t=>{this.images.forEach((a,r)=>{if(a.id==t){this.images.splice(r,1);return}})}),C({showClose:!0,message:e.message,type:"success"}))})}).catch(e=>{})},selectAll(){this.selectedImage=[],this.selectAllFlag?this.images.forEach(e=>{e.select=!0,this.selectedImage.push(e.id)}):this.images.forEach(e=>{e.select=!1}),this.selectAllFlag=!this.selectAllFlag}},computed:{showFlag(){return!!(this.$store.state.isLogin&&this.authorId==this.$store.state.author.username)},coverImg(){let e=this.$store.state.albums,t=e.length;for(let a=0;a<t;a++)if(this.albumName==e[a].albumName)return e[a].coverImg}},watch:{},mounted(){window.addEventListener("scroll",this.handleScroll),this.authorId=this.data.split("_")[0],this.albumName=this.data.split("_")[1],this.queryData.authorId=this.authorId,this.queryData.albumName=this.albumName,y.get("init/getImagesByAlbum",this.queryData).then(e=>{e.code==200&&(e.data.forEach(t=>{t.ok=!1,t.simplifyImg=this.baseUrl+t.simplifyImg,t.originalImg=this.baseUrl+t.originalImg,this.images.push(t),this.originalImg.push(t.originalImg)}),setTimeout(()=>{let t=this.images.length,a=t-e.data.length;for(a;a<t;a++)this.images[a].ok=!0},100),e.data.length<this.queryData.pageSize&&(this.endmsg="\u6CA1\u6709\u66F4\u591A\u4E86...",window.removeEventListener("scroll",this.handleScroll)),this.queryData.startPage=this.queryData.startPage+4,this.queryData.pageSize=8)})},unmounted(){window.removeEventListener("scroll",this.handleScroll)}},K=e=>(H("data-v-42000ab5"),e=e(),M(),e),O={class:"illustration"},Q={class:"ArticleInfo"},W={style:{margin:"20px",color:"rgb(9, 214, 180)","font-size":"100px"}},X=K(()=>n("span",{style:{color:"#06a0e9","font-size":"30px"}}," \u76F8\u518C ",-1)),Y={style:{margin:"0 0 1% 2.5%",height:"30px",opacity:"0.7"}},Z={key:0,style:{margin:"0 0 1% 1%",height:"30px",opacity:"0.7"}},$=["onClick"],ee=["onClick"],te={class:"endmsg"},se={class:"previewbox"},le=["src"];function ae(e,t,a,r,s,o){const v=j,F=E("router-link"),f=R,d=z,I=G,k=E("CircleCheckFilled"),w=B,A=U;return m(),u("div",null,[l(p,{name:"el-fade-in"},{default:i(()=>[n("div",O,[l(v,{fit:"cover",class:"img",src:o.coverImg,alt:"",lazy:""},null,8,["src"]),n("div",Q,[n("h1",W,D(s.albumName),1),l(F,{to:"/Album/"+s.authorId},{default:i(()=>[X]),_:1},8,["to"])])])]),_:1}),l(I,{style:{"margin-top":"30px"}},{default:i(()=>[l(f,{class:"space"}),l(f,{class:"container"},{default:i(()=>[l(I,null,{default:i(()=>[n("div",Y,[o.showFlag?(m(),V(d,{key:0,type:"primary",onClick:o.management},{default:i(()=>[_("\u7BA1\u7406")]),_:1},8,["onClick"])):x("",!0)]),l(p,{name:"el-zoom-in-top"},{default:i(()=>[s.editFlag?(m(),u("div",Z,[l(d,{type:"warning",onClick:o.moveImage},{default:i(()=>[_("\u79FB\u52A8")]),_:1},8,["onClick"]),l(d,{type:"danger",onClick:o.deleteImage},{default:i(()=>[_("\u5220\u9664")]),_:1},8,["onClick"]),l(d,{type:"success",onClick:o.selectAll},{default:i(()=>[_("\u5168\u9009")]),_:1},8,["onClick"])])):x("",!0)]),_:1})]),_:1}),l(I,{class:"body"},{default:i(()=>[(m(!0),u(L,null,P(s.images,(c,S)=>(m(),u("div",{class:"item",key:S},[g(n("div",{onClick:b=>o.selectImage(c)},[g(l(w,{class:"selectIcon"},{default:i(()=>[l(k)]),_:2},1536),[[h,!c.select]]),g(l(w,{class:"selectIcon1"},{default:i(()=>[l(k)]),_:2},1536),[[h,c.select]])],8,$),[[h,s.editFlag]]),l(p,{name:"el-zoom-in-top"},{default:i(()=>[g(n("div",{class:"photoCloak",onClick:b=>o.selectImage(c)},null,8,ee),[[h,s.editFlag]])]),_:2},1024),l(p,{name:"el-zoom-in-top"},{default:i(()=>[g(l(v,{class:"photo",src:c.simplifyImg,fit:"cover",onClick:b=>o.previewImage(c.originalImg)},null,8,["src","onClick"]),[[h,c.ok]])]),_:2},1024)]))),128))]),_:1})]),_:1}),l(f,{class:"space"})]),_:1}),n("div",te,D(s.endmsg),1),l(A,{modelValue:s.previewDialog,"onUpdate:modelValue":t[0]||(t[0]=c=>s.previewDialog=c),width:"70%",top:"60px","append-to-body":!0,style:{"background-color":"aliceblue"}},{default:i(()=>[n("div",se,[n("img",{class:"img",src:s.dialogImageUrl},null,8,le)])]),_:1},8,["modelValue"])])}const ce=q(J,[["render",ae],["__scopeId","data-v-42000ab5"]]);export{ce as default};
